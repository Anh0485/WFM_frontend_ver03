<h2>Work hours Report</h2>

<form [formGroup]="filterForm">
    <div class="box">
        <div class="box-option">
            <div class="form-group">
                <label for="inputState">Employee</label>
                <select id="inputState" class="form-control">
                    <option selected [value]="'All'">All</option>
                    <option *ngFor="let emp of agents" [value]="emp.EmployeeID">{{emp.EmployeeID}} - {{emp.FullName}} -
                        {{emp.RoleName}} - {{emp.TenantName}}</option>
                </select>
            </div>
        </div>
        <div class="box-option">
            <label style="margin-left: 10px;">Date</label>
            <div class="row row-cols-sm-auto" style="display: inline;">
                <div class="col-12" style="margin-bottom: 10px;">
                     <div class="input-group">
                        <input class="form-control" type="date" formControlName="startDate">
                    </div> 
                     <!-- <div class="dp-hidden position-absolute">
                        <div class="input-group">
                            <input 
                            formControlName="startDate" 
                            name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                                [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2"
                                [dayTemplate]="t" outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" />
                            <ng-template #t let-date let-focused="focused">
                                <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                                    [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                                    (mouseleave)="hoveredDate = null">
                                    {{ date.day }}
                                </span>
                            </ng-template>
                        </div>
                    </div> 
                    <div class="input-group">
                        <input
                         #dpFromDate class="form-control" placeholder="yyyy-mm-dd" name="dpFromDate"
                            [value]="formatter.format(fromDate)"
                            (input)="fromDate = validateInput(fromDate, dpFromDate.value)" />
                        <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                            type="button"></button>
                    </div> -->
                </div>
                <div class="col-12" style="margin-top: 10px;">
                     <div class="input-group">
                        <input type="date" class="form-control" formControlName="endDate" />
                    </div>
                    <!-- <div class="input-group">
                        <input formControlName="endDate" #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                            [value]="formatter.format(toDate)"
                            (input)="toDate = validateInput(toDate, dpToDate.value)" />
                        <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                            type="button"></button>
                    </div> -->
                </div>
            </div>
        </div>
        <div class="box-option">
            <div class="form-group">
                <label for="inputState">Channel</label>
                <select id="inputState" class="form-control">
                    <option selected value="'All'">All</option>
                    <option *ngFor="let item of channels" [value]="item.ChannelID">{{ item.ChannelName}}</option>
                </select>
            </div>
        </div>
        <div class="box-option">
            <label for=""></label>
            <button class="btn btn-primary btn-option" (click)="onSubmit()">Submit</button>
        </div>
    </div>
</form>


<div class="report-table">
    <table class="table table-striped">
        <thead>
            <tr style="text-align: center;">
                <th scope="col">EmployeeID</th>
                <th scope="col">Employee</th>
                <th scope="col">Channel</th>
                <th scope="col">Total working hours</th>
            </tr>
        </thead>
        <tbody>
            @if(workhours.length === 0){
            <tr style="text-align: center;">
                <td colspan="4">No information</td>
            </tr>
            }
            @for (workhour of workhours; track workhour.fullname) {
            <tr style="text-align: center;">
                <th scope="row">{{ workhour.EmployeeID }}</th>
                <td>
                    {{ workhour.fullname }}
                </td>
                <td>{{ workhour.ChannelName }}</td>
                <td>{{ workhour.TOTALWORKINGHOURS | number }}</td>
            </tr>
            }
            
        </tbody>
    </table>
    <div class="d-flex justify-content-between p-2">
        <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize"
            (pageChange)="refreshWorkHour()">
        </ngb-pagination>

        <select class="form-select" style="width: auto" [(ngModel)]="pageSize" (ngModelChange)="refreshWorkHour()">
            <option [ngValue]="2">2 items per page</option>
            <option [ngValue]="4">4 items per page</option>
            <option [ngValue]="6">6 items per page</option>
        </select>
    </div>
</div>