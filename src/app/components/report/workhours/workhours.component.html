<h2>Work hours Report</h2>

<form [formGroup]="filterForm">
    
    <div class="box" [ngClass]="{'height-200': filterForm.hasError('dateRangeError')}">
        <div class="box-option">
            <div class="form-group">
                <label for="inputState">Employee</label>
                <select id="inputState" class="form-control" formControlName="EmployeeID" >
                    <option selected [value]="'All'">All</option>
                    <option *ngFor="let emp of agents" [value]="emp.EmployeeID">{{emp.EmployeeID}} - {{emp.FullName}} -
                        {{emp.RoleName}} - {{emp.TenantName}}</option>
                </select>
            </div>
        </div>
        <div class="box-option">
            <label style="margin-left: 10px;">Date</label>
            <div *ngIf="filterForm.hasError('dateRangeError')">The start date cannot be greater than the end date</div>
            <div class="row row-cols-sm-auto" style="display: inline;">
                <div class="col-12" style="margin-bottom: 10px;">
                     <div class="input-group">
                        <input class="form-control" type="date" formControlName="startDate">
                    </div> 
                  
                </div>
                <div class="col-12" style="margin-top: 10px;">
                     <div class="input-group">
                        <input type="date" class="form-control" formControlName="endDate" />
                    </div>
                  
                </div>
            </div>
        </div>
        <div class="box-option">
            <div class="form-group">
                <label for="inputState">Channel</label>
                <select id="inputState" class="form-control" formControlName="ChannelID">
                    <option selected value="All">All</option>
                    <option *ngFor="let item of channels" [value]="item.ChannelID">{{ item.ChannelName}}</option>
                </select>
            </div>
        </div>
        <div class="box-option">
            <label for=""></label>
            <button class="btn btn-primary btn-option" (click)="onSubmit()">Submit</button>
        </div>
    </div>
</form>


<div class="report-table">
    <div class="text" *ngIf="!submitted">
        <p class="font-weight-bold">Data show from {{this.startDateFormatted}} to {{this.endDateFormatted}}</p>
    </div>
    <table class="table table-striped">
        <thead>
            <tr style="text-align: center;">
                <th scope="col">EmployeeID</th>
                <th scope="col">Employee</th>
                <th scope="col">Channel</th>
                <th scope="col">Total working hours</th>
                <th scope="col">Total overtime hours</th>
            </tr>
        </thead>
        <tbody>
            @if(workhours.length === 0){
            <tr style="text-align: center;">
                <td colspan="4">No information</td>
            </tr>
            }
            <!-- @for (workhour of workhours; track workhour.workHour.fullname) { -->
            <tr *ngFor = 'let workhour of workhours' 
            style="text-align: center;">
                <th scope="row">{{ workhour.EmployeeID }}</th>
                <td>
                    {{ workhour.fullname}}
                </td>
                <td>{{ workhour.ChannelName }}</td>
                <td>{{ workhour.TOTALWORKINGHOURS | number }}</td>
                <td>{{ workhour.totalOvertimeHour }}
                    <button class="btn mb-2 me-2" (click)="openDetailOvertimeHourModal(viewOvertimeHourModal, workhour)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                            <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
                            <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
                        </svg>
                    </button>
                </td>
            </tr>
            <!-- } -->
            
        </tbody>
    </table>
    <!-- <div class="d-flex justify-content-between p-2">
        <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize"
            (pageChange)="refreshWorkHour()">
        </ngb-pagination>

        <select class="form-select" style="width: auto" [(ngModel)]="pageSize" (ngModelChange)="refreshWorkHour()">
            <option [ngValue]="2">2 items per page</option>
            <option [ngValue]="4">4 items per page</option>
            <option [ngValue]="6">6 items per page</option>
        </select>
    </div> -->
</div>

<!-- View overtimehour modal -->
<ng-template #viewOvertimeHourModal let-modal>
	<div class="modal-header">
		<h4 class="modal-title">Detail Overtime hour</h4>
		<button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
        <table class="table table-striped">
            <thead>
                <tr>
                    
                    <th scope="col" sortable="name" >EmployeeID</th>
                    <th scope="col" sortable="area" >FullName</th>
                    <th scope="col" sortable="population" >Overtime Hour</th>
                    <th scope="col" sortable="population">Overtime Date</th>
                </tr>
            </thead>
            <tbody>
              
                    <tr *ngFor = "let item of detailOvertimeHour">
                        <td scope="row">{{item.EmployeeID}}</td>
                        <td>{{ item.fullname }}</td>
                        <td>{{ item.OvertimeHour }}</td>
                        <td>{{ item.OvertimeDate }}</td>
                    </tr>
               
            </tbody>
        </table>
	</div>
</ng-template>
